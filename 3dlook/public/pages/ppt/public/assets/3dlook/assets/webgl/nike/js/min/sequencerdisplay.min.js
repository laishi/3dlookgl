function SequencerDisplay(){this.sequencerGroups=null,this.oldSequencerCurserNote=0,this.matUnMarkedSequencer=null,this.matMarkedSequencer=null,this.matCursorSequencer=null,this.padClicked=!1,this.dragSequencerOnOFF=-1,this.songedited=!1,this.effectColor=null,this.dispose=function(){for(var e=0;e<this.sequencerGroups.length;e++){for(var r=0;32>r;r++)this.sequencerGroups[e].remove(this.sequencerGroups[e].children[r]);nike.scene.remove(this.sequencerGroups[e]),this.sequencerGroups[e]=void 0}},this.init=function(){this.matUnMarkedSequencer=new THREE.MeshBasicMaterial({color:3355443,blending:THREE.AdditiveBlending,side:THREE.DoubleSide,wireframe:!1,transparent:!1}),this.matMarkedSequencer=new THREE.MeshBasicMaterial({color:8947848,blending:THREE.AdditiveBlending,side:THREE.DoubleSide,wireframe:!1,transparent:!1}),this.matCursorSequencer=new THREE.MeshBasicMaterial({color:16563819,blending:THREE.AdditiveBlending,side:THREE.DoubleSide,wireframe:!1,transparent:!1}),this.matHoverSequencer=new THREE.MeshBasicMaterial({color:16777215,blending:THREE.AdditiveBlending,side:THREE.DoubleSide,wireframe:!1,transparent:!1}),this.sequencerGroups=[],this.effectColor=new THREE.Color;for(var e=0;e<conf.numShoeGroups;e++){this.sequencerGroups[e]=new THREE.Object3D,nike.scene.add(this.sequencerGroups[e]);for(var r=0;32>r;r++){var n=nike.scene.getObjectByName("Seq_"+e+"_"+r,!0);n.visible=!1,this.sequencerGroups[e].add(n),this.sequencerGroups[e].visible=!1,nike.scene.remove(n)}}$("#pad").mousemove(function(e){if(0!=e.which){$("#padcursor").css({top:e.pageY-15,left:e.pageX-15}),h=window.innerHeight;var r=(e.pageY-$("#pad").offset().top)/$("#pad").height(),n=(e.pageX-$("#pad").offset().left)/$("#pad").width();nike.sequencerDisplay.effectColor.g=.2,nike.sequencerDisplay.effectColor.r=1-2*r+.2,nike.sequencerDisplay.effectColor.b=1-2*n+.2,nike.seqDarkLinesMaterial.color=nike.sequencerDisplay.effectColor,sequencer.setPadValues(n,r)}})},this.update=function(){for(var e=0;e<conf.numShoeGroups;e++)nike.ui.matHover[e].transparent=!1,0==sequencer.triggerArray[e][this.oldSequencerCurserNote]?this.sequencerGroups[e].children[this.oldSequencerCurserNote].material=this.matUnMarkedSequencer:void 0!==this.sequencerGroups[e].children[this.oldSequencerCurserNote]&&(this.sequencerGroups[e].children[this.oldSequencerCurserNote].material=nike.ui.matHover[e]),nike.ui.matHover[e].opacity=1;this.oldSequencerCurserNote=sequencer.currentNote;for(var e=0;e<conf.numShoeGroups;e++)this.sequencerGroups[e].children[sequencer.currentNote].material=this.matCursorSequencer},this.markSequencerShoes=function(){for(var e=0;e<nike.shoeGroups.length;e++)for(var r=0;32>r;r++)this.sequencerGroups[e].children[r].material=1==sequencer.triggerArray[e][r]?nike.ui.matHover[e]:this.matUnMarkedSequencer},this.clearSequencerMaterials=function(){for(var e=0;e<conf.numShoeGroups;e++)for(var r=0;32>r;r++)this.sequencerGroups[e].children[r].material=this.matUnMarkedSequencer},this.switchSequencerGroup=function(e,r){for(var n=0;32>n;n++)this.sequencerGroups[e].children[n].visible=r},this.load=function(e){sequencer.clear(),e=lzw_decode(Base64.decode(e)),sequencer.setState(e),this.markSequencerShoes()},this.click=function(e,r){if(modeSettings.currentMode==MODE_SEQUENCER||modeSettings.currentMode==MODE_DEFAULT){var n=new THREE.Vector3(e.clientX/window.innerWidth*2-1,2*-(e.clientY/window.innerHeight)+1,.5);nike.ui.projector.unprojectVector(n,nike.camera);var i=new THREE.Raycaster(nike.camera.position,n.sub(nike.camera.position).normalize()),s=i.intersectObjects(nike.ui.pickingArrayAreas,!0);if(s.length>0&&(nike.sequencerDisplay.pickedObject=s[0].object,modeSettings.currentMode==MODE_SEQUENCER)){var t=nike.sequencerDisplay.pickedObject.name.split("_")[1],c=nike.sequencerDisplay.pickedObject.name.split("_")[2];if(void 0!=c){var o=nike.sequencerDisplay.sequencerGroups[t].children[c];r?(nike.sequencerDisplay.songedited=!0,sequencer.triggerArray[t][c]=nike.sequencerDisplay.dragSequencerOnOFF):(nike.sequencerDisplay.songedited=!0,sequencer.toggleTrigger(t,c),nike.sequencerDisplay.dragSequencerOnOFF=sequencer.triggerArray[t][c]),o.material=0==nike.sequencerDisplay.dragSequencerOnOFF?nike.sequencerDisplay.matUnMarkedSequencer:nike.ui.matHover[t]}}}}}